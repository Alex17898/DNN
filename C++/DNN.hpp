#include "ap_int.h"

float ReLU(float x);
void convolution1(float input[100], const float kernel[3][3], float output[8][8]);
void convolution2(float input[4][4], const float kernel[16][3][3], float output[16][2][2]);
void maxPooling1(float input[8][8], float output[4][4]);
void maxPooling2(float input[16][2][2], float output[16][1][1]);
int DNN(float input[100]);

namespace weights{
const float conv1_kernel[3][3]={{0.62073636,1.3016608,1.3169551},
                                {0.93985337,2.239962,1.1335186},
                                {1.3545357,1.2723421,0.6531899}};

const float conv2_kernel[16][3][3]={{{0.464158,-0.164211,-0.033772},{0.377202,0.172445,-0.382936},{0.162533,-0.024282,-0.457229}},
                                   {{-0.200352,-0.381725,-0.467966},{-0.195390,0.583456,0.164781},{0.233360,-0.243216,0.394509}},
                                   {{0.769016,-0.419025,0.628492},{0.544643,0.221187,-0.127432},{0.200375,0.465909,-0.377284}},
                                   {{0.401561,0.187798,0.206821},{0.323120,-0.070408,0.038307},{0.300917,-0.628195,0.480919}},
                                   {{0.725693,0.152482,0.053030},{-0.495853,-0.199038,0.252248},{0.344655,0.191512,-0.496959}},
                                   {{0.223611,0.326313,0.047265},{-0.605197,-0.050569,0.143971},{0.235378,0.078205,0.232480}},
                                   {{0.398600,-0.298019,0.485828},{0.371423,0.068262,-0.629060},{0.045139,0.172476,0.336945}},
                                   {{0.201966,-0.139866,0.142161},{0.025586,-0.270743,-0.533747},{0.341945,0.186662,0.391271}},
                                   {{0.859691,-0.284804,-0.827419},{0.316434,-0.043618,-0.161655},{0.254706,0.198915,0.065175}},
                                   {{-0.462938,0.154715,0.393060},{-0.024162,-0.383233,0.381063},{-0.621548,0.320482,0.173381}},
                                   {{-0.186569,-0.122371,0.185145},{0.466514,-0.110769,0.379154},{-0.246640,-0.613752,0.631474}},
                                   {{-1.211820,-0.372362,0.198485},{-0.232592,0.227588,-0.057616},{0.156250,-0.248994,0.568060}},
                                   {{0.287311,0.046300,-0.307004},{0.131512,0.283892,0.648419},{-0.263701,0.014495,-0.148536}},
                                   {{-0.401488,-0.264695,-0.315501},{-0.043085,0.487549,0.264652},{0.362709,-0.455272,-0.094204}},
                                   {{0.039342,0.166311,0.671038},{-0.090612,0.120033,0.052164},{0.277894,-0.031829,0.298722}},
                                   {{-0.268876,0.029959,-0.309535},{-0.409835,0.175409,-0.073108},{0.663340,-0.063969,0.228853}}};
const float fc1_weight[16][16]={{-0.25996768, -0.4432888, -0.019776378, 0.09169748, -0.9217628, -0.38774666, 0.4496984, 0.24283703, -0.9185115, -0.37138098, 0.05647343, -0.22227788, 0.4920288, 0.16808215, 0.04439665, 0.10963464},
{0.099656135, -0.5511525, 0.35052004, -0.1475929, -0.12677638, -0.26893672, -0.18069601, 0.0050269696, -0.008967968, -0.26429865, -0.60765404, -0.008450985, 1.2521706, -0.017674994, -0.45017695, 0.60064894},
{-0.37780973, 0.32307714, 0.7742465, 0.6416613, 0.7149061, -0.07688005, -0.25396225, -0.27813098, 0.42136684, 0.01453945, 0.7658986, 0.048499078, 0.32753417, 0.034506742, 0.15833695, -0.16939113},
{-0.31259185, 0.34473732, 0.38729653, 0.5917158, 0.73308265, 0.07922005, 0.50388896, 0.25908524, -0.4728228, -0.42452237, -0.055023525, -0.192626, -0.15439099, -0.47084096, -0.17137524, 0.21416706},
{0.28670153, 0.94895196, -0.57069695, 0.4617729, 0.89365804, 0.6545328, 0.6985031, 0.05050277, 0.5752092, -0.3092962, -0.12105534, -0.3056023, 0.16795555, -0.38056085, 0.3421589, -0.67297244},
{0.40695754, 0.57821214, -0.65667266, -0.17549384, 0.37855402, -0.8876886, -0.0200149, 0.81459683, -0.20704123, 0.2778714, 0.021138106, -0.053002626, -0.12218408, 0.25812477, -0.42489114, 0.11066037},
{-0.21254447, 0.6029958, 0.15388328, -1.1410805, 0.032810416, -0.1970128, -0.5456901, 1.0040895, -0.095124, 0.07309422, 0.088636436, -0.3352187, 0.63894504, 0.02394861, -0.33922762, 0.11009106},
{-0.103102, -0.10791175, -0.018877208, -0.4128407, 0.6838926, -0.18067333, 0.99123025, 0.03261758, 0.2754647, -0.2253105, -0.44692674, -0.36277413, -0.28272203, -0.08599013, -0.053879593, 0.07947018},
{-0.24528907, 0.12359896, 0.2938715, 0.25412568, -0.23832446, 0.8211485, 0.19702502, 0.6802311, 0.55782586, -0.2782514, -0.9591124, -0.14391363, -0.5872891, -0.0060496335, -0.28571716, 0.3327266},
{-0.26077473, 0.48604792, 0.13513085, 0.23019713, -0.96992975, -0.302572, 0.64090914, -0.0056092185, 0.20005701, -0.33756158, -0.37236908, -0.02755645, 0.08342894, -0.40155202, 0.027825497, 0.6510999},
{-0.023572296, -0.5419139, -0.2311222, 0.61060673, 0.63364154, 0.6243222, 0.41066527, 0.32741722, -0.94084173, -0.18993632, -0.05296776, 0.048065454, 0.78196657, -0.25879252, 0.24656029, 0.24370043},
{-0.038966656, -0.60022426, 0.5328175, -0.3755835, 0.6600584, 0.7084875, -0.16409577, 0.73793536, 0.24721679, 0.22324243, 0.7269096, 0.26516512, -0.48702732, -0.316932, 0.049606908, -0.44900787},
{-0.23087649, -0.0061375177, -0.14456767, 0.60185766, -0.17003621, -0.05655301, -0.3391089, -0.40075403, -0.038648415, 0.23396817, -0.26962978, 0.020236045, 0.42557728, 0.074259154, -0.0015539305, 0.55058956},
{0.14769194, -0.5310604, -0.6447951, -0.3632305, -0.78704315, -0.45028758, 0.546444, 0.53503567, -0.14286143, -0.13155931, -0.13430484, 0.029629588, -1.6010897, 0.08656968, -0.19936128, -1.5016618},
{0.36428657, 0.5098695, -0.3179074, -0.5130003, -0.57123107, 0.3986973, -0.4307013, -0.5528304, 0.45140803, -0.36563227, 0.12861168, -0.108017474, -0.26611936, 0.10786912, -0.22361693, 0.32197335},
{-0.32267886, -0.2147174, -0.20446222, -0.49079913, 0.10658168, -0.7204111, 0.2819787, -0.52734125, -0.25284111, -0.0653072, -0.3384833, -0.060078174, -0.48959577, -0.38030845, -0.35805586, 0.8498274}};
const float fc2_weight[16][12]={{-0.15734601, -0.13989884, -0.090770036, 0.0146069825, -0.35115373, -0.4220051, 0.0199143, -0.46135113, -0.38394225, -0.13903943, 0.29071814, 0.3177666},
{0.4331092, -0.1373656, 0.13006131, 0.524735, 0.67607385, 0.50136024, -0.31001413, 0.7905751, -0.111773394, -0.2942443, -0.035283566, 0.035674427},
{0.4232505, 0.39730102, 0.3391479, -0.7394511, -1.3382256, -0.41034535, -1.1345673, -0.9977434, 0.69839984, 0.13053834, 0.47096732, -0.08925829},
{0.26529565, -0.37439203, -0.43575376, -0.31884098, -0.4594908, 0.66527104, 0.5545673, 0.18071046, 0.8191582, 0.33059365, 0.74471056, -0.15125985},
{0.3826141, 0.059303258, -0.30450532, -0.52466226, 0.47390285, 0.7506244, 0.2405301, -0.712733, 0.6026751, -0.43445474, -1.2389323, 0.24622019},
{-0.809439, 1.036056, 0.49058348, 0.5672537, -0.19624834, -0.017982105, -0.39793408, 0.6000047, 0.9235937, -0.11908105, 0.5566385, -1.5970378},
{0.009880606, 0.66048414, -0.83994925, -0.26120532, 0.35973975, -0.9854012, 1.1067044, -0.11974232, 0.061768472, 0.048116777, 0.49034587, 0.40659806},
{0.5705434, 0.27939755, 0.2993625, 0.58675414, 0.046461694, -0.5622464, 0.5083032, 0.19875284, 0.19754535, 0.34336737, -0.51543665, -0.34371337},
{-0.16404867, 0.43439433, 0.6110183, -0.72591406, 0.7443594, 0.2595709, -0.60716325, 0.6283118, 0.41667172, -0.21262956, 0.15771355, 0.74541897},
{0.108264625, -0.16313031, 0.14084291, -0.034796864, 0.29297137, -0.12705275, 0.33510393, 0.1984036, 0.2162885, -0.24719195, 0.11234558, 0.20836365},
{-0.6473528, 0.8666116, -0.5682581, 1.1209925, 0.19366747, -0.16142638, 0.14078192, 1.032506, 0.22506478, 0.019962734, 0.7348304, -0.28111905},
{-0.3544079, 0.114282906, -0.09039259, 0.38516438, -0.27023333, -0.14712587, -0.426414, 0.40462106, 0.01658377, -0.11453611, 0.15047836, -0.19526678},
{0.06870202, -0.67189384, 0.9061957, -0.098621175, -0.3270992, 0.23422162, 0.9376125, -0.35816264, -0.19720867, -0.29790255, 0.1085607, -0.31424004},
{0.43116567, 0.48801792, 0.12654302, 0.14924367, -0.094035044, 0.3227037, -0.3304913, 0.14480218, -0.07322772, -0.046599656, 0.41973537, 0.08027152},
{0.028643072, -0.12754637, 0.042700976, 0.021953633, -0.34654287, -0.3829164, 0.012146818, 0.04412278, 0.1952818, 0.12801099, -0.33161363, 0.18633507},
{-0.76351005, -0.161811, 0.31307772, 0.44178095, -0.40917212, 0.053433757, 0.05938351, 0.23093157, -0.3334899, -0.0908952, 0.29699558, 0.877791}};
const float output_weight[12][10]={{0.3222602, 0.060230736, -0.066759005, -0.8504004, -0.20643155, 0.73770666, -0.644988, 0.21525607, 1.0703462, -0.14903802},
{0.5357091, 1.0165409, -0.19278498, -0.28703222, 0.89356124, -0.102103256, 1.4094741, -0.40079752, -0.4883033, -1.4280237},
{-0.7463351, 0.15400527, -0.41072795, 0.1909037, 0.6578332, 0.6568306, 0.5868626, -0.87366027, -0.114416234, -0.10223517},
{0.20637637, 1.045404, 0.14088567, 0.5913337, -0.94702256, -0.2634896, -1.900578, -0.6315844, 0.21742715, 0.12673974},
{1.0308373, 0.039982524, 0.61746436, 0.3964369, -0.018270407, 0.8206561, 0.06806872, -0.5515578, -0.6388919, 0.40785703},
{0.45432034, -1.8564714, -0.30338013, 0.22706145, 0.2862326, -0.7098312, -0.1549208, 0.07632233, 0.11551354, 0.13499999},
{-0.9437712, 0.795317, 0.0487741, -0.124939226, 0.44592237, -0.087346606, -0.6755279, 0.8657695, -0.6418255, -0.3746034},
{-0.49429238, 0.4866584, 0.21876262, 0.75388646, -1.0221417, 0.2830407, -0.087809846, 0.8298791, 0.7851863, -0.20379378},
{0.52087474, -0.39596465, 0.5657623, -0.12619954, -0.16242202, 0.31724778, 0.3977905, 0.12073111, -0.15537871, 0.6490027},
{-0.12768172, -0.19187433, 0.179241, 0.14738043, -0.35437042, -0.3030664, -0.25781563, -0.0152643295, 0.47090247, -0.1239474},
{0.82239544, -0.2728822, -0.9140624, -0.815622, 0.6419397, -1.4788431, 0.021112183, 0.15203887, -0.5686431, 0.9395125},
{-0.2762311, -0.08971305, 1.0171463, -0.14294244, -0.26829427, -0.51068616, 0.7395739, 0.06935508, 0.07298855, -1.3470886}};
}
